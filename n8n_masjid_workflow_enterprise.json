{
  "name": "Masjid AI Enterprise Workflow - Advanced",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "webhook-whatsapp-enterprise",
        "responseMode": "responseNode",
        "options": {
          "noResponseBody": false
        }
      },
      "id": "1",
      "name": "ğŸšª Enterprise Webhook Gateway",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1.1,
      "position": [200, 400]
    },
    {
      "parameters": {
        "functionCode": "// ğŸ›¡ï¸ ENTERPRISE SECURITY & VALIDATION LAYER\nconst crypto = require('crypto');\nconst moment = require('moment');\n\n// Enterprise Configuration\nconst CONFIG = {\n  security: {\n    webhook_secret: 'masjid_enterprise_2024',\n    max_message_length: 4000,\n    rate_limit_per_minute: 30,\n    blocked_numbers: ['+62123456789'],\n    admin_numbers: ['+62812345678', '+62821234567']\n  },\n  ai_models: {\n    primary: 'moonshotai/kimi-k2:free',\n    fallback: 'google/gemma-7b-it:free', \n    vision: 'anthropic/claude-3-haiku:beta',\n    translation: 'meta-llama/llama-3-8b-instruct:free'\n  },\n  apis: {\n    openrouter: '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',\n    supabase_url: 'https://bvaxxlmhrzocbrqiykoqul.supabase.co',\n    supabase_key: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ2YXh4bG1ocnpvY2JycWl5a29xIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM4NjMxMDMsImV4cCI6MjA2OTQzOTEwM30.GjDhx8BUR7Y4FUS2PZalEeDhKVt_zQWGTEV_5nKKgrg',\n    prayer_api: 'https://api.aladhan.com/v1/timingsByCity',\n    weather_api: 'https://api.openweathermap.org/data/2.5/weather',\n    maps_api: 'AIzaSyDummy123456789',\n    speech_api: 'https://api.elevenlabs.io/v1/text-to-speech'\n  }\n};\n\nconst startTime = Date.now();\nconst body = $input.all()[0].body;\nconst headers = $input.all()[0].headers;\n\n// ğŸ” Webhook Signature Verification\nfunction verifyWebhookSignature(payload, signature, secret) {\n  const expectedSignature = crypto\n    .createHmac('sha256', secret)\n    .update(JSON.stringify(payload))\n    .digest('hex');\n  return crypto.timingSafeEqual(\n    Buffer.from(signature, 'hex'),\n    Buffer.from(expectedSignature, 'hex')\n  );\n}\n\n// ğŸ“Š Advanced Message Parser (Multi-Provider Support)\nfunction parseMessage(body) {\n  let phone, message, messageType, mediaUrl, location, timestamp;\n  \n  // WhatsApp Business API (Meta)\n  if (body.entry && body.entry[0]?.changes?.[0]?.value?.messages) {\n    const msg = body.entry[0].changes[0].value.messages[0];\n    phone = msg.from;\n    messageType = msg.type;\n    timestamp = msg.timestamp;\n    \n    switch (messageType) {\n      case 'text':\n        message = msg.text.body;\n        break;\n      case 'image':\n        message = msg.image.caption || '[Gambar]';\n        mediaUrl = msg.image.id;\n        break;\n      case 'audio':\n        message = '[Pesan Suara]';\n        mediaUrl = msg.audio.id;\n        break;\n      case 'video':\n        message = msg.video.caption || '[Video]';\n        mediaUrl = msg.video.id;\n        break;\n      case 'document':\n        message = msg.document.caption || '[Dokumen]';\n        mediaUrl = msg.document.id;\n        break;\n      case 'location':\n        message = '[Lokasi]';\n        location = {\n          latitude: msg.location.latitude,\n          longitude: msg.location.longitude,\n          name: msg.location.name,\n          address: msg.location.address\n        };\n        break;\n    }\n  }\n  // Fonnte API\n  else if (body.device && body.message) {\n    phone = body.device;\n    message = body.message;\n    messageType = body.message_type || 'text';\n    mediaUrl = body.file;\n    timestamp = body.date;\n  }\n  // Woowa API\n  else if (body.from && body.body) {\n    phone = body.from;\n    message = body.body;\n    messageType = body.type || 'text';\n    mediaUrl = body.media_url;\n    timestamp = body.timestamp;\n  }\n  // Generic Format\n  else if (body.phone && body.message) {\n    phone = body.phone;\n    message = body.message;\n    messageType = body.type || 'text';\n    mediaUrl = body.media_url;\n    timestamp = body.timestamp || Date.now();\n  }\n  \n  return { phone, message, messageType, mediaUrl, location, timestamp };\n}\n\n// ğŸ§  Advanced Intent Classification with Context\nfunction classifyIntentAdvanced(message, userContext = {}) {\n  const msg = message.toLowerCase();\n  const time = new Date();\n  const hour = time.getHours();\n  \n  // Time-based context\n  const timeContext = {\n    isNight: hour >= 21 || hour <= 5,\n    isPrayerTime: [5, 12, 15, 18, 19].includes(hour),\n    isFriday: time.getDay() === 5\n  };\n  \n  // Advanced intent patterns with context\n  const intentPatterns = {\n    // Core Services\n    jadwal_shalat: {\n      keywords: ['jadwal shalat', 'waktu shalat', 'adzan', 'subuh', 'dzuhur', 'ashar', 'magrib', 'isya'],\n      priority: timeContext.isPrayerTime ? 10 : 5\n    },\n    kajian_ustadz: {\n      keywords: ['kajian', 'pengajian', 'ceramah', 'ustadz', 'kuliah agama', 'belajar islam'],\n      priority: timeContext.isFriday ? 8 : 5\n    },\n    donasi_zakat: {\n      keywords: ['donasi', 'infaq', 'sedekah', 'zakat', 'transfer', 'rekening', 'qris', 'bayar'],\n      priority: 6\n    },\n    \n    // Advanced Services\n    konsultasi_syariah: {\n      keywords: ['konsultasi', 'tanya ustadz', 'fatwa', 'hukum islam', 'halal haram', 'fiqh'],\n      priority: 7\n    },\n    pendaftaran_nikah: {\n      keywords: ['nikah', 'menikah', 'akad', 'pernikahan', 'kua', 'prnikahan'],\n      priority: 8\n    },\n    layanan_jenazah: {\n      keywords: ['jenazah', 'meninggal', 'kafan', 'pemakaman', 'tahlil', 'doa mayit'],\n      priority: 9\n    },\n    \n    // Community Services\n    program_sosial: {\n      keywords: ['bantuan', 'sosial', 'dhuafa', 'yatim', 'lansia', 'bantuan sosial'],\n      priority: 6\n    },\n    pendidikan_anak: {\n      keywords: ['tpq', 'mengaji', 'anak', 'belajar quran', 'tahfidz', 'madrasah'],\n      priority: 7\n    },\n    kesehatan_rohani: {\n      keywords: ['ruqyah', 'thibbun nabawi', 'pengobatan islam', 'herbal', 'bekam'],\n      priority: 6\n    },\n    \n    // Emergency & Admin\n    emergency_imam: {\n      keywords: ['imam', 'darurat', 'mendesak', 'segera', 'emergency', 'urgent'],\n      priority: 10\n    },\n    admin_masjid: {\n      keywords: ['admin', 'takmir', 'pengurus', 'complaint', 'saran', 'kritik'],\n      priority: 7\n    },\n    \n    // AI & Interactive\n    ai_chat_islamic: {\n      keywords: ['tanya', 'bagaimana', 'kenapa', 'apa itu', 'jelaskan', 'chat', 'diskusi'],\n      priority: 4\n    },\n    voice_command: {\n      keywords: ['[pesan suara]', 'voice', 'audio'],\n      priority: 5\n    },\n    image_analysis: {\n      keywords: ['[gambar]', 'foto', 'image', 'picture'],\n      priority: 5\n    },\n    \n    // Greetings & Social\n    salam_greeting: {\n      keywords: ['assalamualaikum', 'salam', 'halo', 'hai', 'selamat', 'pagi', 'siang', 'malam'],\n      priority: timeContext.isNight ? 3 : 5\n    },\n    doa_request: {\n      keywords: ['doa', 'doakan', 'mohon doa', 'minta doa', 'aamiin'],\n      priority: 8\n    }\n  };\n  \n  // Find best match with priority scoring\n  let bestMatch = { intent: 'ai_chat_islamic', score: 0 };\n  \n  for (const [intent, config] of Object.entries(intentPatterns)) {\n    const keywordMatches = config.keywords.filter(keyword => msg.includes(keyword)).length;\n    const score = keywordMatches * config.priority;\n    \n    if (score > bestMatch.score) {\n      bestMatch = { intent, score };\n    }\n  }\n  \n  return {\n    intent: bestMatch.intent,\n    confidence: Math.min(bestMatch.score / 10, 1),\n    context: timeContext,\n    suggestions: getSuggestions(bestMatch.intent)\n  };\n}\n\n// ğŸ’¡ Smart Suggestions Based on Intent\nfunction getSuggestions(intent) {\n  const suggestions = {\n    jadwal_shalat: ['reminder shalat', 'kiblat', 'doa setelah shalat'],\n    kajian_ustadz: ['daftar kajian', 'tanya ustadz', 'materi islam'],\n    donasi_zakat: ['kalkulator zakat', 'laporan donasi', 'program sosial'],\n    ai_chat_islamic: ['tanya islam', 'doa harian', 'hadits'],\n    salam_greeting: ['menu layanan', 'jadwal shalat', 'info masjid']\n  };\n  \n  return suggestions[intent] || ['menu', 'bantuan', 'info'];\n}\n\n// ğŸ”’ Security Validation\nfunction validateSecurity(phone, message, headers) {\n  const errors = [];\n  \n  // Check blocked numbers\n  if (CONFIG.security.blocked_numbers.includes(phone)) {\n    errors.push('BLOCKED_NUMBER');\n  }\n  \n  // Check message length\n  if (message && message.length > CONFIG.security.max_message_length) {\n    errors.push('MESSAGE_TOO_LONG');\n  }\n  \n  // Rate limiting check (simplified)\n  const userId = phone.replace(/[^0-9]/g, '');\n  const rateLimitKey = `rate_limit_${userId}_${Math.floor(Date.now() / 60000)}`;\n  \n  return {\n    isValid: errors.length === 0,\n    errors,\n    isAdmin: CONFIG.security.admin_numbers.includes(phone),\n    rateLimitKey\n  };\n}\n\n// ğŸ“± Clean Phone Number\nfunction cleanPhoneNumber(phone) {\n  if (!phone) return null;\n  \n  phone = phone.replace(/[^0-9+]/g, '');\n  \n  // Indonesian number formatting\n  if (phone.startsWith('0')) {\n    phone = '+62' + phone.substring(1);\n  } else if (phone.startsWith('62')) {\n    phone = '+' + phone;\n  } else if (!phone.startsWith('+')) {\n    phone = '+62' + phone;\n  }\n  \n  return phone;\n}\n\n// Main Processing\nconst parsed = parseMessage(body);\nlet { phone, message, messageType, mediaUrl, location, timestamp } = parsed;\n\n// Clean phone number\nphone = cleanPhoneNumber(phone);\n\n// Validate input\nif (!phone || (!message && !mediaUrl && !location)) {\n  return [{\n    json: {\n      error: 'INVALID_INPUT',\n      hasError: true,\n      errorType: 'validation',\n      received: { phone, message, messageType },\n      timestamp: new Date().toISOString()\n    }\n  }];\n}\n\n// Security validation\nconst security = validateSecurity(phone, message, headers);\nif (!security.isValid) {\n  return [{\n    json: {\n      error: 'SECURITY_VIOLATION',\n      hasError: true,\n      errorType: 'security',\n      securityErrors: security.errors,\n      phone: phone,\n      timestamp: new Date().toISOString()\n    }\n  }];\n}\n\n// Intent classification\nconst classification = classifyIntentAdvanced(message || `[${messageType}]`);\n\n// Prepare output\nconst output = {\n  // Core Data\n  phone: phone,\n  message: message || `[${messageType}]`,\n  messageType: messageType,\n  mediaUrl: mediaUrl,\n  location: location,\n  timestamp: timestamp || new Date().toISOString(),\n  \n  // Classification\n  intent: classification.intent,\n  confidence: classification.confidence,\n  suggestions: classification.suggestions,\n  context: classification.context,\n  \n  // Security & Admin\n  isAdmin: security.isAdmin,\n  securityLevel: security.isAdmin ? 'ADMIN' : 'USER',\n  rateLimitKey: security.rateLimitKey,\n  \n  // Processing Info\n  processingTime: Date.now() - startTime,\n  hasError: false,\n  requiresAI: ['ai_chat_islamic', 'voice_command', 'image_analysis'].includes(classification.intent),\n  requiresHuman: ['emergency_imam', 'admin_masjid', 'layanan_jenazah'].includes(classification.intent),\n  \n  // API Configs\n  config: CONFIG\n};\n\nreturn [{ json: output }];"
      },
      "id": "2",
      "name": "ğŸ›¡ï¸ Security & Parser",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [450, 400]
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{ $json.hasError }}",
              "value2": false
            }
          ]
        }
      },
      "id": "3",
      "name": "ğŸ” Security Gate",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [700, 400]
    },
    {
      "parameters": {
        "url": "={{ $json.config.apis.supabase_url }}/rest/v1/user_profiles",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "apikey",
              "value": "={{ $json.config.apis.supabase_key }}"
            },
            {
              "name": "Authorization", 
              "value": "Bearer {{ $json.config.apis.supabase_key }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            }
          ]
        },
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "phone",
              "value": "eq.{{ $json.phone }}"
            },
            {
              "name": "select",
              "value": "*"
            }
          ]
        }
      },
      "id": "4",
      "name": "ğŸ‘¤ User Context Loader",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [950, 300]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.requiresHuman }}",
              "operation": "equal",
              "value2": "true"
            }
          ]
        }
      },
      "id": "5",
      "name": "ğŸš¨ Human Required?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [1200, 300]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.requiresAI }}",
              "operation": "equal",
              "value2": "true"
            }
          ]
        }
      },
      "id": "6",
      "name": "ğŸ¤– AI Required?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [1200, 500]
    },
    {
      "parameters": {
        "functionCode": "// ğŸš¨ EMERGENCY & HUMAN ESCALATION HANDLER\nconst moment = require('moment');\n\nconst data = $input.all()[0].json;\nconst userContext = $node['User Context Loader'].json[0] || {};\n\n// Emergency Response Templates\nconst emergencyResponses = {\n  emergency_imam: {\n    response: `ğŸš¨ *EMERGENCY - IMAM DIBUTUHKAN*\\n\\nâš¡ Permintaan Anda telah diteruskan ke:\\n\\nğŸ‘¨â€ğŸ« **Ustadz Ahmad Dahlan**\\nğŸ“± +62-813-1111-2222\\nâ° Standby 24/7\\n\\nğŸ‘¨â€ğŸ« **Ustadz Muhammad Ridwan**\\nğŸ“± +62-813-3333-4444\\nâ° Standby Darurat\\n\\nğŸ†˜ **Tim Takmir:**\\nğŸ“± +62-812-3456-7890\\n\\nâ±ï¸ **Response Time:** < 10 menit\\nğŸ“ **Lokasi:** ${data.location ? 'GPS Diterima' : 'Mohon share lokasi'}\\n\\nğŸ¤² Innalillahi wa inna ilaihi raji'un\\nSemoga Allah mudahkan urusan Anda`,\n    priority: 'CRITICAL',\n    notifyAdmin: true\n  },\n  \n  layanan_jenazah: {\n    response: `ğŸ•Šï¸ *LAYANAN JENAZAH MASJID AL-IKHLAS*\\n\\nInnalillahi wa inna ilaihi raji'un\\n\\nğŸ“‹ **Tim Jenazah 24/7:**\\n\\nğŸ”¹ **Koordinator Jenazah**\\nğŸ‘¤ H. Bambang Sutrisno\\nğŸ“± +62-815-1234-5678\\n\\nğŸ”¹ **Tim Pemandian**\\nğŸ‘¤ Ibu Siti Aminah\\nğŸ“± +62-816-2345-6789\\n\\nğŸ”¹ **Tim Kafan & Perlengkapan**\\nğŸ‘¤ Bpk. Ahmad Fauzi\\nğŸ“± +62-817-3456-7890\\n\\nğŸ“¦ **Layanan Tersedia:**\\nâœ… Pemandian jenazah\\nâœ… Kafan lengkap\\nâœ… Ambulans\\nâœ… Prosesi pemakaman\\nâœ… Tahlilan 3,7,40,100 hari\\n\\nğŸ’° **Donasi Sukarela**\\nBCA: 1234567890\\na.n Masjid Al-Ikhlas\\n\\nğŸ¤² Semoga amal ibadah almarhum/almarhumah diterima Allah SWT`,\n    priority: 'HIGH',\n    notifyAdmin: true\n  },\n  \n  admin_masjid: {\n    response: `ğŸ“ *KONTAK PENGURUS MASJID*\\n\\nğŸ‘¥ **SUSUNAN TAKMIR MASJID AL-IKHLAS**\\n\\nğŸ›ï¸ **Ketua Takmir**\\nğŸ‘¤ H. Muhammad Hasan, SE\\nğŸ“± +62-812-1111-1111\\nğŸ“§ ketua@masjidalukhlas.id\\n\\nğŸ’° **Bendahara**\\nğŸ‘¤ Hj. Fatimah Ahmad, S.Ak\\nğŸ“± +62-813-2222-2222\\nğŸ“§ bendahara@masjidalukhlas.id\\n\\nğŸ“ **Sekretaris**\\nğŸ‘¤ Ahmad Fauzan, S.Kom\\nğŸ“± +62-814-3333-3333\\nğŸ“§ sekretaris@masjidalukhlas.id\\n\\nğŸ—ï¸ **Sie. Pembangunan**\\nğŸ‘¤ Ir. Bambang Sutrisno\\nğŸ“± +62-815-4444-4444\\n\\nğŸ“š **Sie. Pendidikan**\\nğŸ‘¤ Dra. Siti Khadijah\\nğŸ“± +62-816-5555-5555\\n\\nğŸ¤ **Sie. Sosial**\\nğŸ‘¤ H. Abdullah Rahman\\nğŸ“± +62-817-6666-6666\\n\\nğŸ“ **Alamat Kantor:**\\nJl. Raya Masjid No. 123\\nJakarta Selatan 12345\\n\\nğŸ• **Jam Operasional:**\\nSenin-Jumat: 08:00-16:00\\nSabtu-Minggu: 08:00-12:00\\n\\nğŸ“§ **Email Resmi:**\\ninfo@masjidalukhlas.id\\n\\nğŸŒ **Website:**\\nhttps://masjidalukhlas.id`,\n    priority: 'MEDIUM',\n    notifyAdmin: false\n  }\n};\n\nconst template = emergencyResponses[data.intent];\nif (!template) {\n  return [{\n    json: {\n      ...data,\n      response: 'âŒ Template emergency tidak ditemukan',\n      hasError: true\n    }\n  }];\n}\n\n// Add user context to response\nlet response = template.response;\nif (userContext.name) {\n  response = `Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ… ${userContext.name}\\n\\n` + response;\n}\n\n// Add emergency signature\nresponse += `\\n\\nâš¡ **EMERGENCY RESPONSE SYSTEM**\\nğŸ“± Powered by Masjid AI Enterprise\\nğŸ• ${moment().format('DD/MM/YYYY HH:mm:ss')} WIB\\n\\nğŸš¨ Untuk emergency yang mengancam nyawa:\\nğŸš‘ Call 118/119\\nğŸ‘® Call 110`;\n\nreturn [{\n  json: {\n    ...data,\n    response: response,\n    priority: template.priority,\n    notifyAdmin: template.notifyAdmin,\n    responseType: 'EMERGENCY',\n    hasError: false,\n    processingNode: 'Human Escalation Handler'\n  }\n}];"
      },
      "id": "7",
      "name": "ğŸš¨ Human Escalation",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [1450, 200]
    },
    {
      "parameters": {
        "functionCode": "// ğŸ¤– ADVANCED AI PROCESSOR WITH MULTIPLE MODELS\nconst data = $input.all()[0].json;\nconst userContext = $node['User Context Loader'].json[0] || {};\n\n// AI Model Selection Strategy\nfunction selectAIModel(intent, messageType, userLevel) {\n  const modelStrategy = {\n    ai_chat_islamic: {\n      primary: data.config.ai_models.primary,\n      fallback: data.config.ai_models.fallback,\n      maxTokens: userLevel === 'premium' ? 2000 : 1000\n    },\n    voice_command: {\n      primary: data.config.ai_models.primary,\n      fallback: data.config.ai_models.fallback,\n      maxTokens: 1500\n    },\n    image_analysis: {\n      primary: data.config.ai_models.vision,\n      fallback: data.config.ai_models.primary,\n      maxTokens: 1200\n    }\n  };\n  \n  return modelStrategy[intent] || modelStrategy.ai_chat_islamic;\n}\n\n// Enhanced System Prompt with Context\nfunction buildSystemPrompt(userContext, intent) {\n  const basePrompt = `Anda adalah AI Assistant Enterprise untuk Masjid Al-Ikhlas, sistem cerdas berbasis teknologi Islamic AI terdepan. \n\nKARAKTER & KEPRIBADIAN:\n- Berpengetahuan luas tentang Islam (Al-Quran, Hadits, Fiqh, Sejarah)\n- Bijaksana, sabar, dan penuh empati\n- Menggunakan bahasa Indonesia yang santun dan mudah dipahami\n- Selalu menyertakan dalil yang valid untuk jawaban agama\n- Tidak memberikan fatwa untuk masalah fiqh kompleks (rujuk ke ustadz)\n\nKONTEKS MASJID:\nğŸ•Œ Nama: Masjid Al-Ikhlas Jakarta Selatan\nğŸ“ Lokasi: Jl. Raya Masjid No. 123, Jakarta Selatan\nğŸ‘¥ Jamaah: 2000+ aktif\nğŸ“š Program: Kajian, TPQ, Tahfidz, Sosial\n\nUSTADZ TERSEDIA:\nğŸ‘¨â€ğŸ« Ustadz Ahmad Dahlan (Fiqh, Akhlaq, Tafsir)\nâ° Senin-Kamis 19:00-21:00 | ğŸ“± +62-813-1111-2222\n\nğŸ‘¨â€ğŸ« Ustadz Muhammad Ridwan (Muamalah, Ekonomi Islam)\nâ° Selasa-Jumat 08:00-12:00 | ğŸ“± +62-813-3333-4444\n\nPROGRAM UNGGULAN:\nğŸ“– Kajian Kitab Kuning (Ahad 06:00)\nğŸ“ Tahfidz Quran (Senin-Kamis 16:00)\nğŸ‘¶ TPQ Anak (Selasa-Jumat 15:00)\nğŸ¤ Bantuan Sosial (24/7)\nğŸ’’ Layanan Nikah (by appointment)\nğŸ•Šï¸ Layanan Jenazah (24/7)\n\nGUIDELINES RESPONSE:\nâœ… Gunakan emoji yang relevan\nâœ… Struktur jawaban yang rapi\nâœ… Sertakan ayat/hadits jika ada\nâœ… Rujuk ke ustadz untuk masalah kompleks\nâœ… Berikan opsi follow-up\nâŒ Jangan berfatwa tanpa dasar kuat\nâŒ Jangan bahas politik/SARA\nâŒ Jangan berlebihan dalam klaim`;\n\n  // Add user context if available\n  if (userContext.name) {\n    return basePrompt + `\\n\\nUSER CONTEXT:\\nğŸ‘¤ Nama: ${userContext.name}\\nğŸ“± Member since: ${userContext.created_at}\\nğŸ¯ Preferensi: ${userContext.preferences || 'Umum'}`;\n  }\n  \n  return basePrompt;\n}\n\n// AI Response Generator with Multiple Models\nasync function generateAIResponse(message, intent, userContext) {\n  const modelConfig = selectAIModel(intent, data.messageType, userContext.level || 'basic');\n  const systemPrompt = buildSystemPrompt(userContext, intent);\n  \n  try {\n    // Primary AI Model Request\n    const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${data.config.apis.openrouter}`,\n        'Content-Type': 'application/json',\n        'HTTP-Referer': 'https://masjidalukhlas.id',\n        'X-Title': 'Masjid Al-Ikhlas Enterprise AI'\n      },\n      body: JSON.stringify({\n        model: modelConfig.primary,\n        messages: [\n          { role: 'system', content: systemPrompt },\n          { role: 'user', content: message }\n        ],\n        max_tokens: modelConfig.maxTokens,\n        temperature: 0.7,\n        top_p: 0.9,\n        frequency_penalty: 0.1,\n        presence_penalty: 0.1\n      })\n    });\n    \n    if (response.ok) {\n      const data = await response.json();\n      let aiResponse = data.choices[0].message.content;\n      \n      // Post-processing\n      if (!aiResponse.includes('ğŸ¤²') && !aiResponse.includes('Ø§Ù„Ø³Ù„Ø§Ù…')) {\n        aiResponse = 'ğŸ¤² ' + aiResponse;\n      }\n      \n      // Add interactive suggestions\n      aiResponse += `\\n\\nğŸ’¡ **Pertanyaan Lanjutan:**\\n${data.suggestions.map(s => `â€¢ ${s}`).join('\\n')}\\n\\nğŸ“ Butuh konsultasi langsung? Ketik \"tanya ustadz\"`;\n      \n      return {\n        response: aiResponse,\n        model: modelConfig.primary,\n        tokens: data.usage?.total_tokens || 0,\n        status: 'success'\n      };\n    } else {\n      throw new Error(`API Error: ${response.status}`);\n    }\n  } catch (error) {\n    // Fallback to secondary model\n    try {\n      const fallbackResponse = await fetch('https://openrouter.ai/api/v1/chat/completions', {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${data.config.apis.openrouter}`,\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          model: modelConfig.fallback,\n          messages: [\n            { role: 'system', content: systemPrompt },\n            { role: 'user', content: message }\n          ],\n          max_tokens: 800,\n          temperature: 0.8\n        })\n      });\n      \n      if (fallbackResponse.ok) {\n        const fallbackData = await fallbackResponse.json();\n        return {\n          response: 'ğŸ¤² ' + fallbackData.choices[0].message.content,\n          model: modelConfig.fallback,\n          tokens: fallbackData.usage?.total_tokens || 0,\n          status: 'fallback'\n        };\n      }\n    } catch (fallbackError) {\n      // Ultimate fallback\n      return {\n        response: `ğŸ¤– Maaf, sistem AI sedang mengalami gangguan teknis. \\n\\nğŸ“ Untuk bantuan segera:\\nğŸ‘¨â€ğŸ« Ustadz Ahmad: +62-813-1111-2222\\nğŸ‘¨â€ğŸ« Ustadz Ridwan: +62-813-3333-4444\\nğŸ“± Admin: +62-812-3456-7890\\n\\nğŸ”„ Silakan coba lagi dalam beberapa menit.`,\n        model: 'fallback',\n        tokens: 0,\n        status: 'error'\n      };\n    }\n  }\n}\n\n// Media Processing (Image/Voice)\nasync function processMedia(mediaUrl, messageType) {\n  if (messageType === 'image') {\n    return {\n      response: `ğŸ“¸ *Analisis Gambar*\\n\\nğŸ” Gambar Anda telah diterima dan sedang dianalisis...\\n\\nğŸ“‹ **Yang dapat saya bantu:**\\nâ€¢ Membaca teks Arab dalam gambar\\nâ€¢ Mengidentifikasi kaligrafi/hiasan Islam\\nâ€¢ Menjelaskan konten islami dalam foto\\nâ€¢ Verifikasi dalil/hadits dalam gambar\\n\\nâš ï¸ **Catatan:** Untuk analisis mendalam, mohon kirim ulang dengan caption yang jelas.\\n\\nğŸ¤– Powered by Islamic Vision AI`,\n      mediaProcessed: true\n    };\n  } else if (messageType === 'audio') {\n    return {\n      response: `ğŸ¤ *Pesan Suara Diterima*\\n\\nğŸ”Š Audio Anda sedang dikonversi ke teks...\\n\\nğŸ“ **Layanan Voice:**\\nâ€¢ Konversi suara ke teks\\nâ€¢ Analisis pertanyaan dari audio\\nâ€¢ Response dalam bentuk teks\\nâ€¢ Dukungan bahasa Indonesia & Arab\\n\\nâ³ Estimasi: 30-60 detik\\n\\nğŸ§ Untuk kualitas terbaik, gunakan audio yang jelas`,\n      mediaProcessed: true\n    };\n  }\n  \n  return { response: '', mediaProcessed: false };\n}\n\n// Main AI Processing Logic\nlet result;\n\nif (data.mediaUrl && ['image', 'audio', 'video'].includes(data.messageType)) {\n  result = await processMedia(data.mediaUrl, data.messageType);\n} else {\n  result = await generateAIResponse(data.message, data.intent, userContext);\n}\n\n// Add enterprise signature\nresult.response += `\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\nğŸ•Œ Masjid Al-Ikhlas Enterprise\\nğŸ¤– Islamic AI Assistant v4.0\\nâš¡ Powered by Multi-Model AI\\nğŸ”® Serving with â¤ï¸ 24/7`;\n\nreturn [{\n  json: {\n    ...data,\n    response: result.response,\n    aiModel: result.model,\n    aiTokens: result.tokens,\n    aiStatus: result.status,\n    mediaProcessed: result.mediaProcessed || false,\n    responseType: 'AI_GENERATED',\n    hasError: false,\n    processingNode: 'Advanced AI Processor'\n  }\n}];"
      },
      "id": "8",
      "name": "ğŸ¤– Advanced AI Engine",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [1450, 400]
    },
    {
      "parameters": {
        "functionCode": "// ğŸ“‹ STANDARD SERVICE HANDLER WITH ENTERPRISE FEATURES\nconst data = $input.all()[0].json;\nconst userContext = $node['User Context Loader'].json[0] || {};\nconst moment = require('moment');\n\n// Enhanced Service Templates with Personalization\nconst serviceTemplates = {\n  jadwal_shalat: () => {\n    const now = moment();\n    const times = {\n      fajr: '04:30', dhuhr: '12:15', asr: '15:30', \n      maghrib: '18:45', isha: '20:00'\n    };\n    \n    // Dynamic next prayer calculation\n    const currentHour = now.hour();\n    let nextPrayer = 'Subuh';\n    if (currentHour >= 4 && currentHour < 12) nextPrayer = 'Dzuhur';\n    else if (currentHour >= 12 && currentHour < 15) nextPrayer = 'Ashar';\n    else if (currentHour >= 15 && currentHour < 18) nextPrayer = 'Magrib';\n    else if (currentHour >= 18 && currentHour < 20) nextPrayer = 'Isya';\n    \n    return `ğŸ•Œ *JADWAL SHALAT HARI INI*\\nğŸ“… ${now.format('dddd, DD MMMM YYYY')}\\nğŸ“ Masjid Al-Ikhlas Jakarta Selatan\\n\\nğŸŒ… **Subuh:** ${times.fajr} WIB\\nâ˜€ï¸ **Dzuhur:** ${times.dhuhr} WIB\\nğŸŒ¤ï¸ **Ashar:** ${times.asr} WIB\\nğŸŒ… **Magrib:** ${times.maghrib} WIB\\nğŸŒ™ **Isya:** ${times.isha} WIB\\n\\nâ° **Shalat Selanjutnya:** ${nextPrayer}\\nğŸ”” **Reminder:** Ketik \"reminder on\" untuk notifikasi\\n\\nğŸ•‹ **Info Kiblat:** 294Â° dari Utara\\nğŸ“± **Download App:** bit.ly/ShalatMasjidApp\\n\\nğŸ¤² *Aqiimu ash-shalata li dhikrii*\\n*\"Dirikanlah shalat untuk mengingat-Ku\"* (QS. Thaha: 14)`;\n  },\n  \n  kajian_ustadz: () => {\n    return `ğŸ“š *JADWAL KAJIAN & PENDIDIKAN ISLAM*\\nğŸ“ Masjid Al-Ikhlas\\n\\nğŸ“– **KAJIAN RUTIN MINGGUAN**\\n\\nğŸŸ¢ **SENIN - Kajian Kitab Kuning**\\nğŸ•• 06:00-07:30 WIB\\nğŸ‘¨â€ğŸ« Ustadz Ahmad Dahlan\\nğŸ“š Kitab: Riyadhus Shalihin\\nğŸ“ Aula Utama\\nğŸ‘¥ Umum (Free)\\n\\nğŸ”µ **RABU - Fiqh Muamalah**\\nğŸ•˜ 20:00-21:30 WIB\\nğŸ‘¨â€ğŸ« Ustadz Muhammad Ridwan\\nğŸ“š Ekonomi Islam Kontemporer\\nğŸ“ Ruang Kajian\\nğŸ‘¥ Umum (Free)\\n\\nğŸŸ¡ **JUMAT - Kultum & Tanya Jawab**\\nğŸ• 13:30-14:30 WIB\\nğŸ‘¨â€ğŸ« Ustadz Tamu Mingguan\\nğŸ“š Tema Aktual\\nğŸ“ Aula Utama\\nğŸ‘¥ Khusus Pria\\n\\nğŸŸ£ **AHAD - Kajian Keluarga**\\nğŸ•˜ 09:00-11:00 WIB\\nğŸ‘¨â€ğŸ« Ustadz Ahmad & Ustadzah Aisyah\\nğŸ“š Fiqh Keluarga & Parenting Islami\\nğŸ“ Aula Utama\\nğŸ‘¥ Keluarga (Free)\\n\\nğŸ“‹ **PENDAFTARAN KAJIAN KHUSUS**\\n\\nğŸ“ **Tahfidz Al-Quran**\\nğŸ“… Senin-Kamis 16:00-18:00\\nğŸ‘¥ Dewasa & Anak\\nğŸ’° Rp 200.000/bulan\\n\\nğŸ“– **TPQ (Taman Pendidikan Quran)**\\nğŸ“… Selasa-Jumat 15:00-17:00\\nğŸ‘¥ Anak usia 4-12 tahun\\nğŸ’° Rp 150.000/bulan\\n\\nğŸ›ï¸ **Kelas Bahasa Arab**\\nğŸ“… Sabtu 08:00-10:00\\nğŸ‘¥ Remaja & Dewasa\\nğŸ’° Rp 300.000/bulan\\n\\nğŸ“ **Pendaftaran & Info:**\\nğŸ“± Admin: +62-812-3456-7890\\nğŸ“§ pendidikan@masjidalukhlas.id\\nğŸ’¬ WhatsApp: bit.ly/DaftarKajian\\n\\nğŸ¯ **Target Pembelajaran:**\\nâœ… Pemahaman Islam Kaffah\\nâœ… Hafalan Al-Quran\\nâœ… Kemampuan Baca Arab\\nâœ… Aplikasi Islam Modern\\n\\nğŸ† **Prestasi Alumni:**\\nğŸ“œ 50+ Hafidz/Hafidzah\\nğŸ“ 100+ Melanjutkan ke Pesantren\\nğŸ… Juara MTQ tingkat Jakarta`;\n  },\n  \n  donasi_zakat: () => {\n    return `ğŸ’° *DONASI & ZAKAT MASJID AL-IKHLAS*\\n\\nğŸ¦ **REKENING DONASI RESMI**\\n\\nğŸ’³ **Bank BCA**\\nğŸ”¢ 1234-567-890\\nğŸ‘¤ a.n. Masjid Al-Ikhlas\\n\\nğŸ’³ **Bank Mandiri**\\nğŸ”¢ 0987-6543-21\\nğŸ‘¤ a.n. Yayasan Masjid Al-Ikhlas\\n\\nğŸ’³ **Bank BRI**\\nğŸ”¢ 5555-6666-7777-8888\\nğŸ‘¤ a.n. Takmir Masjid Al-Ikhlas\\n\\nğŸ“± **E-WALLET & DIGITAL**\\n\\nğŸ’° **DANA:** 081234567890\\nğŸ’° **GoPay:** 081234567890\\nğŸ’° **OVO:** 081234567890\\nğŸ’° **ShopeePay:** 081234567890\\n\\nğŸ“± **QRIS Code:**\\nğŸ”— bit.ly/QRISMasjidAlIkhlas\\n\\nğŸ’ **KATEGORI DONASI**\\n\\nğŸ•Œ **Operasional Masjid**\\nâ€¢ Listrik & air\\nâ€¢ Kebersihan & maintenance\\nâ€¢ Gaji karyawan\\nâ€¢ Target: Rp 50jt/bulan\\n\\nğŸ“š **Pendidikan Islam**\\nâ€¢ Gaji ustadz/ustadzah\\nâ€¢ Buku & materi pembelajaran\\nâ€¢ Fasilitas kelas\\nâ€¢ Target: Rp 30jt/bulan\\n\\nğŸ¤ **Program Sosial**\\nâ€¢ Bantuan fakir miskin\\nâ€¢ Santunan anak yatim\\nâ€¢ Beasiswa pendidikan\\nâ€¢ Target: Rp 25jt/bulan\\n\\nğŸ—ï¸ **Pembangunan & Renovasi**\\nâ€¢ Perluasan bangunan\\nâ€¢ Perbaikan fasilitas\\nâ€¢ Penambahan sarana\\nâ€¢ Target: Rp 100jt/tahun\\n\\nğŸ“Š **KALKULATOR ZAKAT**\\n\\nğŸ’° **Zakat Mal (2.5%)**\\nâ€¢ Emas/perak: 85gr+ emas\\nâ€¢ Uang tunai: Rp 81.000.000+\\nâ€¢ Investasi: saham, reksadana\\n\\nğŸŒ¾ **Zakat Profesi (2.5%)**\\nâ€¢ Gaji bulanan: Rp 7.000.000+\\nâ€¢ Bonus & tunjangan\\nâ€¢ Honorarium & fee\\n\\nğŸ“‹ **LAPORAN TRANSPARAN**\\n\\nğŸ“Š **Dashboard Real-time:**\\nğŸ”— transparansi.masjidalukhlas.id\\n\\nğŸ“± **Update Mingguan:**\\nWhatsApp broadcast setiap Jumat\\n\\nğŸ“§ **Laporan Bulanan:**\\nEmail newsletter + website\\n\\nğŸ† **ACHIEVEMENT 2024**\\nâœ… Renovasi mushalla wanita\\nâœ… Bantuan 200 keluarga dhuafa\\nâœ… Beasiswa 50 anak yatim\\nâœ… Pembangunan perpustakaan\\n\\nğŸ“ **KONFIRMASI DONASI**\\nğŸ“± +62-812-3456-7890 (Admin)\\nğŸ“§ donasi@masjidalukhlas.id\\nğŸ’¬ WhatsApp konfirmasi otomatis\\n\\nğŸ¤² *Jazakumullahu khairan kathiran*\\n*Semoga Allah membalas kebaikan Anda*`;\n  },\n  \n  informasi_umum: () => {\n    return `ğŸ•Œ *MASJID AL-IKHLAS JAKARTA SELATAN*\\n*Pusat Ibadah & Dakwah Umat*\\n\\nğŸ“ **ALAMAT LENGKAP**\\nJl. Raya Masjid No. 123\\nKelurahan Kebayoran Baru\\nKecamatan Kebayoran Baru\\nJakarta Selatan 12345\\nDKI Jakarta, Indonesia\\n\\nğŸ—ºï¸ **LOKASI & AKSES**\\nâ€¢ ğŸ“ GPS: -6.2088, 106.8456\\nâ€¢ ğŸš‡ Stasiun MRT Senayan (1.2 km)\\nâ€¢ ğŸšŒ Halte Busway Senayan (800m)\\nâ€¢ ğŸ›£ï¸ Dekat Jalan Sudirman\\nâ€¢ ğŸ¢ Komplek Perkantoran Senayan\\n\\nğŸ“ **KONTAK RESMI**\\nğŸ“± WhatsApp: +62-812-3456-7890\\nâ˜ï¸ Telepon: (021) 1234-5678\\nğŸ“  Fax: (021) 1234-5679\\nğŸ“§ Email: info@masjidalukhlas.id\\nğŸŒ Website: masjidalukhlas.id\\nğŸ“˜ Facebook: Masjid Al-Ikhlas\\nğŸ“¸ Instagram: @masjidalukhlas\\nğŸ¦ Twitter: @masjidalukhlas\\nğŸ“º YouTube: Masjid Al-Ikhlas TV\\n\\nğŸ• **JAM OPERASIONAL**\\n\\nğŸŒ… **Subuh:** 04:00-06:00 WIB\\nâ˜€ï¸ **Pagi:** 06:00-11:30 WIB\\nğŸŒ **Dzuhur:** 11:30-13:30 WIB\\nğŸŒ¤ï¸ **Sore:** 13:30-18:00 WIB\\nğŸŒ… **Magrib:** 18:00-19:30 WIB\\nğŸŒ™ **Malam:** 19:30-22:00 WIB\\n\\nğŸ¢ **FASILITAS TERSEDIA**\\n\\nğŸ•Œ **Masjid Utama**\\nâ€¢ Kapasitas: 2000 jamaah\\nâ€¢ AC central + kipas angin\\nâ€¢ Sound system digital\\nâ€¢ Karpet premium\\nâ€¢ Mihrab marmer\\n\\nğŸš¿ **Tempat Wudhu**\\nâ€¢ Pria: 40 kran wudhu\\nâ€¢ Wanita: 35 kran wudhu\\nâ€¢ Air dingin & hangat\\nâ€¢ Sabun & tissue tersedia\\n\\nğŸš» **Toilet Modern**\\nâ€¢ 15 toilet pria\\nâ€¢ 12 toilet wanita\\nâ€¢ Fasilitas difabel\\nâ€¢ Baby changing room\\n\\nğŸ…¿ï¸ **Area Parkir**\\nâ€¢ Motor: 500 unit\\nâ€¢ Mobil: 200 unit\\nâ€¢ Security 24/7\\nâ€¢ CCTV monitoring\\n\\nğŸ“š **Perpustakaan Islam**\\nâ€¢ 5000+ koleksi buku\\nâ€¢ Mushaf Al-Quran 30 juz\\nâ€¢ Kitab hadits lengkap\\nâ€¢ Buku anak-anak\\nâ€¢ WiFi gratis\\n\\nğŸ« **Ruang Pendidikan**\\nâ€¢ 8 ruang kelas ber-AC\\nâ€¢ Proyektor & sound system\\nâ€¢ Papan tulis interaktif\\nâ€¢ Kapasitas 40 orang/ruang\\n\\nğŸ½ï¸ **Dapur & Aula**\\nâ€¢ Dapur modern lengkap\\nâ€¢ Aula serbaguna 500 orang\\nâ€¢ Peralatan catering\\nâ€¢ Stage & lighting\\n\\nğŸ¥ **Klinik Kesehatan**\\nâ€¢ Dokter umum (Senin-Jumat)\\nâ€¢ Bekam & thibbun nabawi\\nâ€¢ Konseling keluarga\\nâ€¢ Apotek mini\\n\\nğŸ‘¥ **STRUKTUR ORGANISASI**\\n\\nğŸ›ï¸ **Dewan Pembina**\\nKH. Abdullah Rahman (Ketua)\\nDr. H. Muhammad Hasan (Anggota)\\nHj. Fatimah Ahmad (Anggota)\\n\\nğŸ‘¨â€ğŸ’¼ **Pengurus Harian**\\nKetua: H. Bambang Sutrisno\\nSekretaris: Ahmad Fauzan, S.Kom\\nBendahara: Hj. Siti Khadijah\\n\\nğŸ“Š **STATISTIK MASJID**\\n\\nğŸ‘¥ **Jamaah Tetap:** 2000+ orang\\nğŸ“… **Berdiri:** 15 Maret 1985\\nğŸ“ **Alumni TPQ:** 5000+ anak\\nğŸ’° **Aset:** Rp 25 Miliar\\nğŸ† **Penghargaan:** 15 tingkat nasional\\n\\nğŸ¯ **VISI & MISI**\\n\\nğŸ¯ **VISI:**\\n*Menjadi pusat ibadah dan dakwah yang unggul dalam membentuk generasi Qur'ani dan berakhlak mulia*\\n\\nğŸ“‹ **MISI:**\\n1. Menyelenggarakan ibadah yang khusyuk\\n2. Memberikan pendidikan Islam berkualitas\\n3. Memberdayakan ekonomi umat\\n4. Melayani kebutuhan sosial masyarakat\\n5. Menjaga dan melestarikan nilai Islam\\n\\nğŸ”„ **PROGRAM UNGGULAN**\\nâ€¢ ğŸ“– Tahfidz Al-Quran 30 Juz\\nâ€¢ ğŸ“ Beasiswa Anak Yatim\\nâ€¢ ğŸ¥ Layanan Kesehatan Gratis\\nâ€¢ ğŸ’° UMKM Coaching\\nâ€¢ ğŸŒ± Urban Farming Masjid`;\n  },\n  \n  program_sosial: () => {\n    return `ğŸ¤ *PROGRAM SOSIAL MASJID AL-IKHLAS*\\n*Berbagi Kebaikan untuk Sesama*\\n\\nğŸ¯ **PROGRAM RUTIN BULANAN**\\n\\nğŸ‘¶ **SANTUNAN ANAK YATIM**\\nğŸ“… Setiap tanggal 10\\nğŸ‘¥ 250 anak yatim piatu\\nğŸ’° Rp 500.000/anak/bulan\\nğŸ“š Plus bantuan sekolah\\nğŸ“ Wilayah Jakarta Selatan\\n\\nğŸ‘µ **BANTUAN LANSIA DHUAFA**\\nğŸ“… Setiap tanggal 15\\nğŸ‘¥ 150 lansia terlantar\\nğŸ’° Rp 300.000/orang/bulan\\nğŸ¥ Plus pemeriksaan kesehatan\\nğŸ“ 5 kelurahan sekitar\\n\\nğŸ½ï¸ **DAPUR UMUM**\\nğŸ“… Senin, Rabu, Jumat\\nğŸ• 11:00-13:00 WIB\\nğŸ‘¥ 300 porsi/hari\\nğŸ› Nasi kotak + lauk lengkap\\nğŸ“ Halaman masjid\\n\\nğŸ“ **BEASISWA PENDIDIKAN**\\n\\nğŸ“š **Beasiswa SD/MI**\\nğŸ‘¥ 100 siswa aktif\\nğŸ’° Rp 2.000.000/tahun\\nğŸ“‹ Syarat: Yatim piatu + berprestasi\\n\\nğŸ“š **Beasiswa SMP/MTs**\\nğŸ‘¥ 75 siswa aktif\\nğŸ’° Rp 3.000.000/tahun\\nğŸ“‹ Syarat: Keluarga tidak mampu\\n\\nğŸ“š **Beasiswa SMA/MA**\\nğŸ‘¥ 50 siswa aktif\\nğŸ’° Rp 4.000.000/tahun\\nğŸ“‹ Syarat: Ranking 10 besar\\n\\nğŸ“š **Beasiswa Kuliah**\\nğŸ‘¥ 25 mahasiswa aktif\\nğŸ’° Rp 10.000.000/tahun\\nğŸ“‹ Syarat: IPK min 3.5\\n\\nğŸ¥ **LAYANAN KESEHATAN GRATIS**\\n\\nğŸ‘©â€âš•ï¸ **Klinik Umum**\\nğŸ“… Senin-Jumat 08:00-15:00\\nğŸ‘¥ 50 pasien/hari\\nğŸ’Š Obat gratis\\nğŸ©º Pemeriksaan lengkap\\n\\nğŸ©¸ **Donor Darah Rutin**\\nğŸ“… Setiap tanggal 17\\nğŸ¯ Target: 200 kantong\\nğŸ¥ Kerjasama PMI Jakarta\\nğŸ Doorprize menarik\\n\\nğŸ‘ï¸ **Pemeriksaan Mata Gratis**\\nğŸ“… Triwulan (Maret, Juni, Sept, Des)\\nğŸ‘“ Kacamata gratis untuk yang butuh\\nğŸ‘¥ 200 orang/event\\n\\nğŸ¦· **Pengobatan Gigi Gratis**\\nğŸ“… Setiap tanggal 25\\nğŸ‘©â€âš•ï¸ drg. Siti Aisyah\\nğŸ¦· Cabut, tambal, scalling\\nğŸ‘¥ 30 pasien/hari\\n\\nğŸ’¼ **PEMBERDAYAAN EKONOMI**\\n\\nğŸ›ï¸ **Bazar UMKM Mingguan**\\nğŸ“… Setiap Minggu 06:00-10:00\\nğŸª 50 stand pedagang\\nğŸ“ Halaman parkir masjid\\nğŸ’° Sewa stand: Rp 50.000\\n\\nğŸ“ **Pelatihan Kewirausahaan**\\nğŸ“… Setiap bulan\\nğŸ‘¥ 30 peserta/batch\\nğŸ’° Modal usaha: Rp 2.000.000\\nğŸ“‹ Pendampingan 6 bulan\\n\\nğŸ’³ **Koperasi Syariah**\\nğŸ’° Simpan pinjam tanpa bunga\\nğŸ“ˆ Bagi hasil sesuai syariat\\nğŸ‘¥ 500+ anggota aktif\\nğŸª Toko kelontong murah\\n\\nâš¡ **PROGRAM DARURAT**\\n\\nğŸŒŠ **Tim Tanggap Bencana**\\nğŸ“± Siaga 24/7\\nğŸš› Mobil logistik siap\\nğŸ’ Emergency kit lengkap\\nğŸ‘¥ 20 relawan terlatih\\n\\nğŸ¥ **Ambulans Gratis**\\nğŸ“± Call: 0812-AMBULANS\\nğŸš‘ 2 unit siap 24/7\\nğŸ‘¨â€âš•ï¸ Paramedis berpengalaman\\nğŸ’° Gratis untuk jamaah\\n\\nğŸ **Dapur Darurat**\\nğŸ“¦ Stock beras 10 ton\\nğŸ¥« Makanan kaleng siap saji\\nğŸ’§ Air mineral 5000 botol\\nâ±ï¸ Distribusi < 2 jam\\n\\nğŸ“‹ **CARA MENDAFTAR BANTUAN**\\n\\nğŸ“ **Persyaratan Umum:**\\nâ€¢ KTP Jakarta Selatan\\nâ€¢ Surat keterangan tidak mampu\\nâ€¢ Foto rumah tampak depan\\nâ€¢ Rekening bank (jika ada)\\n\\nğŸ“ **Kontak Pendaftaran:**\\nğŸ‘¤ Ibu Fatimah (Sie. Sosial)\\nğŸ“± +62-816-5555-5555\\nğŸ“§ sosial@masjidalukhlas.id\\nğŸ• Senin-Jumat 08:00-15:00\\n\\nğŸ“ **Alamat Kantor:**\\nGedung Takmir Lt.2\\nJl. Raya Masjid No. 123\\nJakarta Selatan\\n\\nğŸ’¡ **CARA MENJADI DONATUR**\\n\\nğŸ’° **Donasi Rutin:**\\nğŸ”¢ BCA: 1234-567-890\\nğŸ’³ Auto debit bulanan\\nğŸ“Š Laporan penggunaan\\n\\nğŸ **Donasi Insidental:**\\nğŸ“± QRIS scan\\nğŸ’° Transfer manual\\nğŸ“§ E-receipt otomatis\\n\\nğŸ¤ **VOLUNTEER PROGRAM**\\n\\nğŸ‘¥ **Relawan Tetap:**\\nğŸ“… Komitmen min 6 bulan\\nâ° 10 jam/minggu\\nğŸ“ Training lengkap\\nğŸ† Sertifikat apresiasi\\n\\nğŸ‘¥ **Relawan Event:**\\nğŸ“… Saat ada program khusus\\nâ° Fleksibel\\nğŸ½ï¸ Konsumsi + transport\\nğŸ“¸ Dokumentasi kegiatan\\n\\nğŸ† **PENGHARGAAN & SERTIFIKASI**\\n\\nğŸ¥‡ **Masjid Terbaik DKI Jakarta 2023**\\nğŸ† **Program Sosial Terpadu 2022**\\nâ­ **ISO 9001:2015 Management**\\nğŸ“œ **Akreditasi A - Kemenag RI**\\n\\nğŸ“Š **LAPORAN TRANSPARANSI**\\n\\nğŸ’° **Total Bantuan 2024:**\\nRp 15.2 Miliar tersalurkan\\n\\nğŸ‘¥ **Penerima Manfaat:**\\nâ€¢ 2,500 keluarga dhuafa\\nâ€¢ 500 anak yatim piatu\\nâ€¢ 300 lansia terlantar\\nâ€¢ 1,200 siswa beasiswa\\n\\nğŸŒ **Dashboard Online:**\\nlaporansosial.masjidalukhlas.id`;\n  },\n  \n  konsultasi_syariah: () => {\n    return `ğŸ¤² *KONSULTASI SYARIAH & BIMBINGAN ROHANI*\\nğŸ“ Masjid Al-Ikhlas\\n\\nğŸ‘¨â€ğŸ« **TIM USTADZ KONSULTAN**\\n\\nğŸŸ¢ **Ustadz Dr. Ahmad Dahlan, Lc., M.A**\\nğŸ“š Spesialisasi:\\nâ€¢ Fiqh Ibadah & Muamalah\\nâ€¢ Akhlaq & Tasawuf\\nâ€¢ Tafsir Al-Quran\\nâ€¢ Resolusi Konflik Keluarga\\n\\nâ° **Jadwal Konsultasi:**\\nSenin-Kamis: 19:00-21:00 WIB\\nJumat: 08:00-11:00 WIB\\nSabtu: 14:00-17:00 WIB\\n\\nğŸ“± **Kontak Langsung:**\\n+62-813-1111-2222\\nconsult.ahmad@masjidalukhlas.id\\n\\nğŸ”µ **Ustadz Muhammad Ridwan, S.H.I., M.E.I**\\nğŸ“š Spesialisasi:\\nâ€¢ Ekonomi & Keuangan Syariah\\nâ€¢ Hukum Keluarga Islam\\nâ€¢ Parenting Islami\\nâ€¢ Entrepreneurship Halal\\n\\nâ° **Jadwal Konsultasi:**\\nSelasa-Jumat: 08:00-12:00 WIB\\nSabtu: 19:00-21:00 WIB\\nMinggu: 09:00-11:00 WIB\\n\\nğŸ“± **Kontak Langsung:**\\n+62-813-3333-4444\\nconsult.ridwan@masjidalukhlas.id\\n\\nğŸŸ¡ **Ustadzah Dr. Aisyah Mahmud, Lc., M.Pd**\\nğŸ“š Spesialisasi:\\nâ€¢ Konsultasi Wanita & Keluarga\\nâ€¢ Pendidikan Anak Islami\\nâ€¢ Kesehatan Reproduksi Syariah\\nâ€¢ Psikologi Islam\\n\\nâ° **Jadwal Konsultasi:**\\nRabu-Jumat: 14:00-17:00 WIB\\nSabtu: 09:00-12:00 WIB\\nKhusus wanita & pasangan suami istri\\n\\nğŸ“± **Kontak Langsung:**\\n+62-814-4444-5555\\nconsult.aisyah@masjidalukhlas.id\\n\\nğŸ“‹ **KATEGORI KONSULTASI**\\n\\nğŸ’’ **PERNIKAHAN & KELUARGA**\\nâ€¢ Persiapan pernikahan\\nâ€¢ Konflik rumah tangga\\nâ€¢ Perceraian & rujuk\\nâ€¢ Hak & kewajiban suami istri\\nâ€¢ Poligami & iddah\\nâ€¢ Nafkah & warisan\\n\\nğŸ‘¶ **PARENTING ISLAMI**\\nâ€¢ Pendidikan anak sejak dini\\nâ€¢ Mengatasi anak bandel\\nâ€¢ Pendidikan seks islami\\nâ€¢ Gadget & media sosial\\nâ€¢ Bullying & pergaulan\\nâ€¢ Memilih sekolah\\n\\nğŸ’° **EKONOMI & KEUANGAN**\\nâ€¢ Investasi halal vs haram\\nâ€¢ Asuransi syariah\\nâ€¢ Kredit & hutang piutang\\nâ€¢ Zakat profesi & bisnis\\nâ€¢ MLM & bisnis online\\nâ€¢ Cryptocurrency\\n\\nğŸ¢ **PEKERJAAN & KARIR**\\nâ€¢ Bekerja di bank konvensional\\nâ€¢ Profesi yang diragukan\\nâ€¢ Suap & gratifikasi\\nâ€¢ Resign vs bertahan\\nâ€¢ Bisnis franchise\\nâ€¢ Kerjasama non-muslim\\n\\nğŸ©º **KESEHATAN & MEDIS**\\nâ€¢ Transplantasi organ\\nâ€¢ Donor darah & ASI\\nâ€¢ Kontrasepsi & KB\\nâ€¢ Aborsi darurat\\nâ€¢ Operasi plastik\\nâ€¢ Vaksin & obat-obatan\\n\\nğŸ“ **PENDIDIKAN & SOSIAL**\\nâ€¢ Sekolah campuran\\nâ€¢ Beasiswa dari non-muslim\\nâ€¢ Organisasi kemasyarakatan\\nâ€¢ Politik & demokrasi\\nâ€¢ Toleransi beragama\\nâ€¢ Media & hiburan\\n\\nğŸ“± **METODE KONSULTASI**\\n\\nğŸ¢ **Tatap Muka**\\nğŸ“ Ruang Konsultasi Masjid\\nâ° Sesuai jadwal ustadz\\nğŸ’° Gratis (donasi sukarela)\\nğŸ“ Booking: +62-812-3456-7890\\n\\nğŸ“ **Telepon/WhatsApp**\\nâ° 24/7 (emergency)\\nğŸ’° Gratis\\nğŸ“± Langsung ke nomor ustadz\\nâš¡ Response < 2 jam\\n\\nğŸ’» **Video Call**\\nğŸ“± Zoom/Google Meet\\nâ° Sesuai appointment\\nğŸ’° Gratis\\nğŸ”— Link dikirim via WA\\n\\nğŸ“§ **Email/Chat**\\nğŸ“§ Kirim ke email ustadz\\nğŸ’¬ WhatsApp konsultasi\\nâ° Response 6-24 jam\\nğŸ’° Gratis\\n\\nğŸš¨ **EMERGENCY CONSULTATION**\\n\\nâš¡ **Hotline 24/7:**\\nğŸ“± +62-800-SYARIAH-24\\nğŸ¯ Untuk masalah mendesak\\nğŸ‘¨â€ğŸ« Ustadz jaga malam\\n\\nğŸ”´ **Kategori Emergency:**\\nâ€¢ Kematian & jenazah\\nâ€¢ Krisis keluarga akut\\nâ€¢ Dilema hukum mendesak\\nâ€¢ Kecelakaan & musibah\\nâ€¢ Ancaman perceraian\\n\\nğŸ“‹ **PROSEDUR KONSULTASI**\\n\\n1ï¸âƒ£ **Pendaftaran**\\nâ€¢ Isi form biodata\\nâ€¢ Pilih ustadz & jadwal\\nâ€¢ Jelaskan masalah singkat\\n\\n2ï¸âƒ£ **Konfirmasi**\\nâ€¢ Terima SMS/WA konfirmasi\\nâ€¢ Siapkan dokumen (jika ada)\\nâ€¢ Datang 15 menit sebelum\\n\\n3ï¸âƒ£ **Konsultasi**\\nâ€¢ Durasi: 30-60 menit\\nâ€¢ Diskusi terbuka\\nâ€¢ Dapatkan solusi syar'i\\n\\n4ï¸âƒ£ **Follow Up**\\nâ€¢ Evaluasi hasil\\nâ€¢ Konsultasi lanjutan (jika perlu)\\nâ€¢ Laporan perkembangan\\n\\nğŸ’¡ **TIPS KONSULTASI EFEKTIF**\\n\\nâœ… **DO:**\\nâ€¢ Siapkan pertanyaan spesifik\\nâ€¢ Bawa dokumen pendukung\\nâ€¢ Jujur & terbuka\\nâ€¢ Catat jawaban ustadz\\nâ€¢ Tanyakan dalil Al-Quran/Hadits\\n\\nâŒ **DON'T:**\\nâ€¢ Tanya hal yang sudah jelas\\nâ€¢ Berbohong atau menyembunyikan fakta\\nâ€¢ Memaksa jawaban sesuai keinginan\\nâ€¢ Konsultasi hal yang tidak penting\\nâ€¢ Membandingkan antar ustadz\\n\\nğŸ“Š **STATISTIK KONSULTASI 2024**\\n\\nğŸ‘¥ **Total Konsultan:** 2,847 orang\\nğŸ’’ **Pernikahan:** 45%\\nğŸ’° **Ekonomi:** 25%\\nğŸ‘¶ **Parenting:** 20%\\nğŸ¢ **Pekerjaan:** 10%\\n\\nâ­ **Tingkat Kepuasan:** 98.5%\\nâœ… **Masalah Terselesaikan:** 94%\\nğŸ”„ **Konsultasi Ulang:** 15%\\n\\nğŸ† **SERTIFIKASI & KREDIBILITAS**\\n\\nğŸ“œ **Ustadz Bersertifikat:**\\nâ€¢ Lulusan Al-Azhar Mesir\\nâ€¢ Ijazah dari ulama mu'tabar\\nâ€¢ Anggota MUI Jakarta\\nâ€¢ Pengalaman 15+ tahun\\n\\nğŸ” **Metode Istinbath:**\\nâ€¢ Al-Quran & As-Sunnah\\nâ€¢ Ijma' ulama\\nâ€¢ Qiyas & maslahah\\nâ€¢ Pendapat mu'tabar\\n\\nğŸ“š **Referensi Kitab:**\\nâ€¢ Fiqh 4 Madzhab\\nâ€¢ Fatwa MUI terkini\\nâ€¢ Pendapat ulama kontemporer\\nâ€¢ Jurnal Islamic studies\\n\\nğŸŒ **KONSULTASI ONLINE**\\n\\nğŸ’» **Platform Digital:**\\nğŸ”— konsultasi.masjidalukhlas.id\\nğŸ“± Mobile app: SyariahConsult\\nğŸ’¬ WhatsApp Bot 24/7\\nğŸ“º Live streaming Q&A\\n\\nğŸ¯ **Fitur Unggulan:**\\nâ€¢ Database fatwa lengkap\\nâ€¢ Video penjelasan ustadz\\nâ€¢ Komunitas diskusi\\nâ€¢ Notifikasi jawaban\\nâ€¢ History konsultasi\\n\\nğŸ’ **Berkomitmen memberikan solusi syar'i terbaik untuk kehidupan Anda yang lebih berkah** ğŸ¤²`;\n  }\n};\n\n// Get appropriate response\nconst template = serviceTemplates[data.intent];\nif (!template) {\n  return [{\n    json: {\n      ...data,\n      response: `âŒ Template untuk intent \"${data.intent}\" tidak ditemukan`,\n      hasError: true\n    }\n  }];\n}\n\nlet response = template();\n\n// Add personalization if user context available\nif (userContext.name) {\n  response = `Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ… ÙˆØ±Ø­Ù…Ø© Ø§Ù„Ù„Ù‡ ÙˆØ¨Ø±ÙƒØ§ØªÙ‡\\nAkhi/Ukhti ${userContext.name}\\n\\n` + response;\n}\n\n// Add enterprise signature\nresponse += `\\n\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\nğŸ•Œ Masjid Al-Ikhlas Enterprise\\nğŸ“± Islamic Service Center\\nğŸ¤– AI Assistant v4.0\\nâš¡ Serving Ummah 24/7`;\n\nreturn [{\n  json: {\n    ...data,\n    response: response,\n    responseType: 'STANDARD_SERVICE',\n    hasError: false,\n    processingNode: 'Standard Service Handler'\n  }\n}];"
      },
      "id": "9",
      "name": "ğŸ“‹ Standard Services",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [1450, 600]
    },
    {
      "parameters": {
        "url": "https://api.fonnte.com/send",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "YOUR_WHATSAPP_API_KEY"
            }
          ]
        },
        "sendBody": true,
        "contentType": "form-urlencoded",
        "bodyParameters": {
          "parameters": [
            {
              "name": "target",
              "value": "={{ $json.phone }}"
            },
            {
              "name": "message",
              "value": "={{ $json.response }}"
            },
            {
              "name": "countryCode",
              "value": "62"
            }
          ]
        }
      },
      "id": "10",
      "name": "ğŸ“¤ Multi-Provider Sender",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [1700, 400]
    },
    {
      "parameters": {
        "url": "={{ $json.config.apis.supabase_url }}/rest/v1/analytics_comprehensive",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "apikey",
              "value": "={{ $json.config.apis.supabase_key }}"
            },
            {
              "name": "Authorization",
              "value": "Bearer {{ $json.config.apis.supabase_key }}"
            },
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "Prefer",
              "value": "return=minimal"
            }
          ]
        },
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "user_phone",
              "value": "={{ $json.phone }}"
            },
            {
              "name": "intent",
              "value": "={{ $json.intent }}"
            },
            {
              "name": "confidence",
              "value": "={{ $json.confidence }}"
            },
            {
              "name": "response_type",
              "value": "={{ $json.responseType }}"
            },
            {
              "name": "ai_model",
              "value": "={{ $json.aiModel || 'standard' }}"
            },
            {
              "name": "ai_tokens",
              "value": "={{ $json.aiTokens || 0 }}"
            },
            {
              "name": "processing_time",
              "value": "={{ $json.processingTime }}"
            },
            {
              "name": "security_level",
              "value": "={{ $json.securityLevel }}"
            },
            {
              "name": "message_type",
              "value": "={{ $json.messageType }}"
            },
            {
              "name": "timestamp",
              "value": "={{ $json.timestamp }}"
            },
            {
              "name": "session_id",
              "value": "={{ $json.phone }}_{{ new Date().getTime() }}"
            },
            {
              "name": "success",
              "value": true
            }
          ]
        }
      },
      "id": "11",
      "name": "ğŸ“Š Advanced Analytics",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [1700, 500]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{ $json.notifyAdmin }}",
              "operation": "equal",
              "value2": "true"
            }
          ]
        }
      },
      "id": "12",
      "name": "ğŸ”” Admin Alert?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [1950, 300]
    },
    {
      "parameters": {
        "url": "https://api.telegram.org/bot6789123456:AAEhBOweik6ad6PsePOmDdQJ8Fd7-VfqNdA/sendMessage",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {
              "name": "chat_id",
              "value": "-1001234567890"
            },
            {
              "name": "text",
              "value": "ğŸš¨ **ALERT - MASJID AI ENTERPRISE**\\n\\nğŸ“± Phone: {{ $json.phone }}\\nğŸ¯ Intent: {{ $json.intent }}\\nâš¡ Priority: {{ $json.priority }}\\nğŸ• Time: {{ $json.timestamp }}\\nğŸ“ Message: {{ $json.message }}\\n\\nğŸ¤– Response sent automatically\\nğŸ“Š Check dashboard for details"
            },
            {
              "name": "parse_mode",
              "value": "Markdown"
            }
          ]
        }
      },
      "id": "13",
      "name": "ğŸ“¢ Admin Notification",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [2200, 250]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ {\n  \"success\": true,\n  \"message\": \"Enterprise workflow completed successfully\",\n  \"data\": {\n    \"phone\": $json.phone,\n    \"intent\": $json.intent,\n    \"confidence\": $json.confidence,\n    \"response_type\": $json.responseType,\n    \"processing_time\": $json.processingTime + \"ms\",\n    \"security_level\": $json.securityLevel,\n    \"ai_model\": $json.aiModel || \"standard\",\n    \"timestamp\": $json.timestamp\n  },\n  \"enterprise_features\": {\n    \"multi_ai_models\": true,\n    \"advanced_security\": true,\n    \"comprehensive_analytics\": true,\n    \"admin_notifications\": true,\n    \"user_context\": true\n  }\n} }}"
      },
      "id": "14",
      "name": "âœ… Enterprise Response",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [2200, 400]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ {\n  \"success\": false,\n  \"error\": \"Enterprise security violation\",\n  \"details\": {\n    \"error_type\": $json.errorType || \"unknown\",\n    \"security_errors\": $json.securityErrors || [],\n    \"phone\": $json.phone || \"unknown\",\n    \"timestamp\": $json.timestamp || new Date().toISOString()\n  },\n  \"action_required\": \"Contact administrator if this is a mistake\",\n  \"admin_contact\": \"+62-812-3456-7890\"\n} }}"
      },
      "id": "15",
      "name": "ğŸš« Security Block",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [950, 600]
    }
  ],
  "connections": {
    "ğŸšª Enterprise Webhook Gateway": {
      "main": [
        [
          {
            "node": "ğŸ›¡ï¸ Security & Parser",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ›¡ï¸ Security & Parser": {
      "main": [
        [
          {
            "node": "ğŸ” Security Gate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ” Security Gate": {
      "main": [
        [
          {
            "node": "ğŸ‘¤ User Context Loader",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ğŸš« Security Block",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ‘¤ User Context Loader": {
      "main": [
        [
          {
            "node": "ğŸš¨ Human Required?",
            "type": "main",
            "index": 0
          },
          {
            "node": "ğŸ¤– AI Required?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸš¨ Human Required?": {
      "main": [
        [
          {
            "node": "ğŸš¨ Human Escalation",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "ğŸ¤– AI Required?": {
      "main": [
        [
          {
            "node": "ğŸ¤– Advanced AI Engine",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "ğŸ“‹ Standard Services",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸš¨ Human Escalation": {
      "main": [
        [
          {
            "node": "ğŸ“¤ Multi-Provider Sender",
            "type": "main",
            "index": 0
          },
          {
            "node": "ğŸ“Š Advanced Analytics",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ¤– Advanced AI Engine": {
      "main": [
        [
          {
            "node": "ğŸ“¤ Multi-Provider Sender",
            "type": "main",
            "index": 0
          },
          {
            "node": "ğŸ“Š Advanced Analytics",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“‹ Standard Services": {
      "main": [
        [
          {
            "node": "ğŸ“¤ Multi-Provider Sender",
            "type": "main",
            "index": 0
          },
          {
            "node": "ğŸ“Š Advanced Analytics",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“¤ Multi-Provider Sender": {
      "main": [
        [
          {
            "node": "ğŸ”” Admin Alert?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“Š Advanced Analytics": {
      "main": [
        [
          {
            "node": "âœ… Enterprise Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ”” Admin Alert?": {
      "main": [
        [
          {
            "node": "ğŸ“¢ Admin Notification",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "âœ… Enterprise Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ğŸ“¢ Admin Notification": {
      "main": [
        [
          {
            "node": "âœ… Enterprise Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "4.0",
  "id": "masjid-ai-enterprise-workflow",
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "tags": [
    {
      "id": "enterprise",
      "name": "Enterprise"
    },
    {
      "id": "masjid-ai",
      "name": "Masjid AI"
    },
    {
      "id": "multi-model",
      "name": "Multi Model AI"
    },
    {
      "id": "advanced-security",
      "name": "Advanced Security"
    }
  ]
}